<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 620" font-family="-apple-system, BlinkMacSystemFont, 'SF Pro Display', 'Segoe UI', sans-serif">
  <defs>
    <linearGradient id="iosBg" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#007AFF" stop-opacity="0.18"/><stop offset="100%" stop-color="#007AFF" stop-opacity="0.06"/></linearGradient>
    <linearGradient id="androidBg" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#3ddc84" stop-opacity="0.18"/><stop offset="100%" stop-color="#3ddc84" stop-opacity="0.06"/></linearGradient>
    <linearGradient id="macosBg" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#8b5cf6" stop-opacity="0.18"/><stop offset="100%" stop-color="#8b5cf6" stop-opacity="0.06"/></linearGradient>
    <linearGradient id="webBg" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#06b6d4" stop-opacity="0.18"/><stop offset="100%" stop-color="#06b6d4" stop-opacity="0.06"/></linearGradient>
    <linearGradient id="winBg" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#f59e0b" stop-opacity="0.18"/><stop offset="100%" stop-color="#f59e0b" stop-opacity="0.06"/></linearGradient>
    <linearGradient id="ffiBg" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#fbbf24" stop-opacity="0.15"/><stop offset="100%" stop-color="#fbbf24" stop-opacity="0.04"/></linearGradient>
    <linearGradient id="directBg" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#8b5cf6" stop-opacity="0.15"/><stop offset="100%" stop-color="#8b5cf6" stop-opacity="0.04"/></linearGradient>
    <linearGradient id="rustBg" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="#ce422b" stop-opacity="0.18"/><stop offset="100%" stop-color="#ce422b" stop-opacity="0.05"/></linearGradient>
  </defs>

  <!-- Background -->
  <rect width="1200" height="620" rx="12" fill="#0f1117"/>

  <!-- ═══ SECTION LABEL: Application Layer ═══ -->
  <text x="24" y="28" fill="#fbbf24" font-size="10" font-weight="700" letter-spacing="2.5" text-transform="uppercase">APPLICATION LAYER</text>

  <!-- ═══ PLATFORM BOXES (5 columns) ═══ -->
  <!-- iOS -->
  <rect x="16" y="40" width="220" height="100" rx="8" fill="url(#iosBg)" stroke="#2d3148" stroke-width="1.2"/>
  <rect x="16" y="40" width="220" height="3" rx="1.5" fill="#007AFF"/>
  <text x="30" y="62" fill="#e2e8f0" font-size="13" font-weight="600">iOS / iPadOS</text>
  <rect x="134" y="50" width="52" height="16" rx="8" fill="#007AFF"/>
  <text x="143" y="61" fill="#fff" font-size="8.5" font-weight="600">SwiftUI</text>
  <text x="30" y="80" fill="#8892b0" font-size="9" font-family="'SF Mono','Fira Code',monospace">GalleryView  ThemePreviewView</text>
  <text x="30" y="93" fill="#8892b0" font-size="9" font-family="'SF Mono','Fira Code',monospace">ColorGradingView  DetectionView</text>
  <text x="30" y="108" fill="#8892b0" font-size="8">VisionKit  Core Image  PHPicker</text>

  <!-- Android -->
  <rect x="248" y="40" width="220" height="100" rx="8" fill="url(#androidBg)" stroke="#2d3148" stroke-width="1.2"/>
  <rect x="248" y="40" width="220" height="3" rx="1.5" fill="#3ddc84"/>
  <text x="262" y="62" fill="#e2e8f0" font-size="13" font-weight="600">Android</text>
  <rect x="326" y="50" width="62" height="16" rx="8" fill="#3ddc84"/>
  <text x="333" y="61" fill="#000" font-size="8.5" font-weight="600">Compose</text>
  <text x="262" y="80" fill="#8892b0" font-size="9" font-family="'SF Mono','Fira Code',monospace">GalleryScreen  ThemePreview</text>
  <text x="262" y="93" fill="#8892b0" font-size="9" font-family="'SF Mono','Fira Code',monospace">ColorGradingScreen  ImagePreview</text>
  <text x="262" y="108" fill="#8892b0" font-size="8">ML Kit  MediaStore  CameraX  Material 3</text>

  <!-- macOS -->
  <rect x="480" y="40" width="220" height="100" rx="8" fill="url(#macosBg)" stroke="#2d3148" stroke-width="1.2"/>
  <rect x="480" y="40" width="220" height="3" rx="1.5" fill="#8b5cf6"/>
  <text x="494" y="62" fill="#e2e8f0" font-size="13" font-weight="600">macOS</text>
  <rect x="546" y="50" width="38" height="16" rx="8" fill="#8b5cf6"/>
  <text x="552" y="61" fill="#fff" font-size="8.5" font-weight="600">egui</text>
  <text x="494" y="80" fill="#8892b0" font-size="9" font-family="'SF Mono','Fira Code',monospace">main.rs  app.rs  tabs/*</text>
  <text x="494" y="93" fill="#8892b0" font-size="9" font-family="'SF Mono','Fira Code',monospace">ui_components</text>
  <text x="494" y="108" fill="#8892b0" font-size="8">HEIF (macOS API)  VisionKit faces</text>

  <!-- Web (WASM) -->
  <rect x="712" y="40" width="220" height="100" rx="8" fill="url(#webBg)" stroke="#2d3148" stroke-width="1.2"/>
  <rect x="712" y="40" width="220" height="3" rx="1.5" fill="#06b6d4"/>
  <text x="726" y="62" fill="#e2e8f0" font-size="13" font-weight="600">Web (WASM)</text>
  <rect x="826" y="50" width="38" height="16" rx="8" fill="#06b6d4"/>
  <text x="832" y="61" fill="#fff" font-size="8.5" font-weight="600">egui</text>
  <text x="726" y="80" fill="#8892b0" font-size="9" font-family="'SF Mono','Fira Code',monospace">main.rs  app.rs  tabs/*</text>
  <text x="726" y="93" fill="#8892b0" font-size="9" font-family="'SF Mono','Fira Code',monospace">web_helper.rs  Trunk bundler</text>
  <text x="726" y="108" fill="#8892b0" font-size="8">libheif-js  ONNX Runtime Web</text>

  <!-- Windows / Linux -->
  <rect x="944" y="40" width="240" height="100" rx="8" fill="url(#winBg)" stroke="#2d3148" stroke-width="1.2"/>
  <rect x="944" y="40" width="240" height="3" rx="1.5" fill="#f59e0b"/>
  <text x="958" y="62" fill="#e2e8f0" font-size="13" font-weight="600">Windows / Linux</text>
  <rect x="1086" y="50" width="38" height="16" rx="8" fill="#8b5cf6"/>
  <text x="1092" y="61" fill="#fff" font-size="8.5" font-weight="600">egui</text>
  <text x="958" y="80" fill="#8892b0" font-size="9" font-family="'SF Mono','Fira Code',monospace">main.rs  app.rs  tabs/*</text>
  <text x="958" y="93" fill="#8892b0" font-size="9" font-family="'SF Mono','Fira Code',monospace">ui_components</text>
  <text x="958" y="108" fill="#8892b0" font-size="8">libheif  Cross-platform binary</text>

  <!-- ═══ ARROWS: Platform → Bridge ═══ -->
  <!-- iOS arrow (FFI dashed yellow) -->
  <line x1="126" y1="144" x2="126" y2="178" stroke="#fbbf24" stroke-width="1.5" stroke-dasharray="4,3"/>
  <polygon points="120,178 126,188 132,178" fill="#fbbf24"/>
  <text x="136" y="172" fill="#8892b0" font-size="8" font-family="'SF Mono','Fira Code',monospace">@_silgen_name</text>

  <!-- Android arrow (FFI dashed yellow) -->
  <line x1="358" y1="144" x2="358" y2="178" stroke="#fbbf24" stroke-width="1.5" stroke-dasharray="4,3"/>
  <polygon points="352,178 358,188 364,178" fill="#fbbf24"/>
  <text x="368" y="172" fill="#8892b0" font-size="8" font-family="'SF Mono','Fira Code',monospace">JNA / JNI</text>

  <!-- macOS arrow (Direct dashed purple) -->
  <line x1="590" y1="144" x2="590" y2="178" stroke="#8b5cf6" stroke-width="1.5" stroke-dasharray="6,3"/>
  <polygon points="584,178 590,188 596,178" fill="#8b5cf6"/>
  <text x="600" y="172" fill="#8892b0" font-size="8" font-family="'SF Mono','Fira Code',monospace">Direct API</text>

  <!-- Web arrow (wasm-bindgen dashed cyan) -->
  <line x1="822" y1="144" x2="822" y2="178" stroke="#06b6d4" stroke-width="1.5" stroke-dasharray="6,3"/>
  <polygon points="816,178 822,188 828,178" fill="#06b6d4"/>
  <text x="832" y="172" fill="#8892b0" font-size="8" font-family="'SF Mono','Fira Code',monospace">wasm-bindgen</text>

  <!-- Win/Linux arrow (Direct dashed purple) -->
  <line x1="1064" y1="144" x2="1064" y2="178" stroke="#8b5cf6" stroke-width="1.5" stroke-dasharray="6,3"/>
  <polygon points="1058,178 1064,188 1070,178" fill="#8b5cf6"/>
  <text x="1074" y="172" fill="#8892b0" font-size="8" font-family="'SF Mono','Fira Code',monospace">Direct API</text>

  <!-- ═══ SECTION LABEL: Bridge Layer ═══ -->
  <text x="24" y="208" fill="#fbbf24" font-size="10" font-weight="700" letter-spacing="2.5">BRIDGE LAYER</text>

  <!-- ═══ BRIDGE ROW ═══ -->
  <!-- Left: FFI Bridge -->
  <rect x="16" y="218" width="452" height="150" rx="8" fill="url(#ffiBg)" stroke="#fbbf24" stroke-width="1.5" stroke-dasharray="6,3"/>
  <text x="242" y="240" fill="#fbbf24" font-size="13" font-weight="600" text-anchor="middle">C Foreign Function Interface</text>

  <!-- iOS FFI sub-box -->
  <rect x="30" y="250" width="204" height="64" rx="6" fill="rgba(0,0,0,0.25)"/>
  <rect x="30" y="250" width="3" height="64" rx="1.5" fill="#fbbf24"/>
  <text x="44" y="268" fill="#fbbf24" font-size="10" font-weight="600">iOS  (Swift → C → Rust)</text>
  <text x="44" y="283" fill="#8892b0" font-size="8.5" font-family="'SF Mono','Fira Code',monospace">RustBridge.swift</text>
  <text x="44" y="296" fill="#8892b0" font-size="8.5" font-family="'SF Mono','Fira Code',monospace">FaceDetectionBridge.swift</text>
  <text x="44" y="309" fill="#8892b0" font-size="8.5" font-family="'SF Mono','Fira Code',monospace">ChamaOptics-Bridging-Header.h</text>

  <!-- Android FFI sub-box -->
  <rect x="246" y="250" width="210" height="64" rx="6" fill="rgba(0,0,0,0.25)"/>
  <rect x="246" y="250" width="3" height="64" rx="1.5" fill="#fbbf24"/>
  <text x="260" y="268" fill="#fbbf24" font-size="10" font-weight="600">Android  (Kotlin → JNA → C → Rust)</text>
  <text x="260" y="283" fill="#8892b0" font-size="8.5" font-family="'SF Mono','Fira Code',monospace">NativeBridge.kt</text>
  <text x="260" y="296" fill="#8892b0" font-size="8.5" font-family="'SF Mono','Fira Code',monospace">ChamaOpticsLib.kt</text>
  <text x="260" y="309" fill="#8892b0" font-size="8.5" font-family="'SF Mono','Fira Code',monospace">NativeStructs.kt</text>

  <!-- FFI stats -->
  <text x="242" y="352" fill="#8892b0" font-size="10" text-anchor="middle"><tspan fill="#fbbf24" font-family="'SF Mono','Fira Code',monospace" font-size="9">ffi_ios.rs</tspan> · <tspan fill="#fbbf24" font-family="'SF Mono','Fira Code',monospace" font-size="9">ffi.rs</tspan> (shared)</text>

  <!-- Right: Direct Rust API + Web -->
  <rect x="480" y="218" width="704" height="150" rx="8" fill="url(#directBg)" stroke="#8b5cf6" stroke-width="1.5"/>
  <text x="832" y="240" fill="#8b5cf6" font-size="13" font-weight="600" text-anchor="middle">Direct Rust API (Desktop &amp; Web)</text>
  <text x="832" y="258" fill="#8892b0" font-size="10" text-anchor="middle">Desktop &amp; Web call Rust core directly — Web via wasm-bindgen for browser APIs</text>

  <!-- macOS sub-box -->
  <rect x="494" y="272" width="200" height="72" rx="6" fill="rgba(0,0,0,0.25)"/>
  <rect x="494" y="272" width="3" height="72" rx="1.5" fill="#8b5cf6"/>
  <text x="508" y="290" fill="#8b5cf6" font-size="10" font-weight="600">macOS</text>
  <text x="508" y="305" fill="#8892b0" font-size="8.5" font-family="'SF Mono','Fira Code',monospace">egui immediate-mode GUI</text>
  <text x="508" y="318" fill="#8892b0" font-size="8.5" font-family="'SF Mono','Fira Code',monospace">HEIF via macOS API</text>
  <text x="508" y="331" fill="#8892b0" font-size="8.5" font-family="'SF Mono','Fira Code',monospace">VisionKit face detection</text>

  <!-- Web sub-box -->
  <rect x="706" y="272" width="200" height="72" rx="6" fill="rgba(0,0,0,0.25)"/>
  <rect x="706" y="272" width="3" height="72" rx="1.5" fill="#06b6d4"/>
  <text x="720" y="290" fill="#06b6d4" font-size="10" font-weight="600">Web (WASM)</text>
  <text x="720" y="305" fill="#8892b0" font-size="8.5" font-family="'SF Mono','Fira Code',monospace">egui → Trunk → WASM</text>
  <text x="720" y="318" fill="#8892b0" font-size="8.5" font-family="'SF Mono','Fira Code',monospace">wasm-bindgen / web-sys</text>
  <text x="720" y="331" fill="#8892b0" font-size="8.5" font-family="'SF Mono','Fira Code',monospace">JS bridge for browser APIs</text>

  <!-- Win/Linux sub-box -->
  <rect x="918" y="272" width="254" height="72" rx="6" fill="rgba(0,0,0,0.25)"/>
  <rect x="918" y="272" width="3" height="72" rx="1.5" fill="#8b5cf6"/>
  <text x="932" y="290" fill="#8b5cf6" font-size="10" font-weight="600">Windows / Linux</text>
  <text x="932" y="305" fill="#8892b0" font-size="8.5" font-family="'SF Mono','Fira Code',monospace">egui immediate-mode GUI</text>
  <text x="932" y="318" fill="#8892b0" font-size="8.5" font-family="'SF Mono','Fira Code',monospace">libheif for HEIF support</text>
  <text x="932" y="331" fill="#8892b0" font-size="8.5" font-family="'SF Mono','Fira Code',monospace">Cross-platform binary</text>

  <!-- ═══ CONNECTOR: Bridge → Core ═══ -->
  <line x1="242" y1="372" x2="242" y2="406" stroke="#ce422b" stroke-width="2"/>
  <polygon points="236,406 242,416 248,406" fill="#ce422b"/>
  <text x="256" y="400" fill="#8892b0" font-size="8" font-family="'SF Mono','Fira Code',monospace">extern "C" #[repr(C)]</text>

  <line x1="832" y1="372" x2="832" y2="406" stroke="#ce422b" stroke-width="2"/>
  <polygon points="826,406 832,416 838,406" fill="#ce422b"/>
  <text x="846" y="400" fill="#8892b0" font-size="8" font-family="'SF Mono','Fira Code',monospace">native Rust calls + wasm-bindgen</text>

  <!-- ═══ SECTION LABEL: Core Layer ═══ -->
  <text x="24" y="434" fill="#fbbf24" font-size="10" font-weight="700" letter-spacing="2.5">CORE LAYER</text>

  <!-- ═══ RUST CORE ═══ -->
  <rect x="16" y="444" width="1168" height="160" rx="8" fill="url(#rustBg)" stroke="rgba(206,66,43,0.3)" stroke-width="1.5"/>
  <text x="600" y="468" fill="#e2e8f0" font-size="14" font-weight="600" text-anchor="middle">Rust Core Library</text>
  <text x="600" y="484" fill="#8892b0" font-size="10" text-anchor="middle">chama-optics · git submodule shared across all platforms (Desktop / iOS / Android / Web)</text>

  <!-- Module boxes (3x2 grid) -->
  <!-- Row 1 -->
  <rect x="30" y="496" width="175" height="96" rx="6" fill="rgba(0,0,0,0.3)" stroke="rgba(255,255,255,0.06)"/>
  <text x="44" y="514" fill="#ce422b" font-size="10" font-weight="600">Theme Engine</text>
  <text x="44" y="530" fill="#8892b0" font-size="8">11 built-in themes</text>
  <text x="44" y="543" fill="#8892b0" font-size="8">JSON parameter schema</text>
  <text x="44" y="556" fill="#8892b0" font-size="8">Text overlay rendering</text>
  <text x="44" y="569" fill="#8892b0" font-size="8">Variable font support</text>

  <rect x="217" y="496" width="178" height="96" rx="6" fill="rgba(0,0,0,0.3)" stroke="rgba(255,255,255,0.06)"/>
  <text x="231" y="514" fill="#ce422b" font-size="10" font-weight="600">Image Processing</text>
  <text x="231" y="530" fill="#8892b0" font-size="8">JPEG / PNG / HEIF / WebP</text>
  <text x="231" y="543" fill="#8892b0" font-size="8">EXIF extraction</text>
  <text x="231" y="556" fill="#8892b0" font-size="8">mozjpeg compression</text>
  <text x="231" y="569" fill="#8892b0" font-size="8">Scale / resize / crop</text>

  <rect x="407" y="496" width="178" height="96" rx="6" fill="rgba(0,0,0,0.3)" stroke="rgba(255,255,255,0.06)"/>
  <text x="421" y="514" fill="#ce422b" font-size="10" font-weight="600">Face Detection</text>
  <text x="421" y="530" fill="#8892b0" font-size="8">InsightFace ONNX</text>
  <text x="421" y="543" fill="#8892b0" font-size="8">Mosaic &amp; stroke effects</text>
  <text x="421" y="556" fill="#8892b0" font-size="8">Sticker overlay system</text>
  <text x="421" y="569" fill="#8892b0" font-size="8">Per-face configuration</text>

  <rect x="597" y="496" width="178" height="96" rx="6" fill="rgba(0,0,0,0.3)" stroke="rgba(255,255,255,0.06)"/>
  <text x="611" y="514" fill="#ce422b" font-size="10" font-weight="600">Color Grading</text>
  <text x="611" y="530" fill="#8892b0" font-size="8">3D lookup tables (.cube)</text>
  <text x="611" y="543" fill="#8892b0" font-size="8">Panasonic / Nikon presets</text>
  <text x="611" y="556" fill="#8892b0" font-size="8">7 adjustment sliders</text>
  <text x="611" y="569" fill="#8892b0" font-size="8">Real-time preview</text>

  <rect x="787" y="496" width="178" height="96" rx="6" fill="rgba(0,0,0,0.3)" stroke="rgba(255,255,255,0.06)"/>
  <text x="801" y="514" fill="#ce422b" font-size="10" font-weight="600">Font Rendering</text>
  <text x="801" y="530" fill="#8892b0" font-size="8">FreeType-based</text>
  <text x="801" y="543" fill="#8892b0" font-size="8">Variable font axes</text>
  <text x="801" y="556" fill="#8892b0" font-size="8">Embedded &amp; custom</text>
  <text x="801" y="569" fill="#8892b0" font-size="8">Text alignment engine</text>

  <rect x="977" y="496" width="195" height="96" rx="6" fill="rgba(0,0,0,0.3)" stroke="rgba(255,255,255,0.06)"/>
  <text x="991" y="514" fill="#ce422b" font-size="10" font-weight="600">Export &amp; Effects</text>
  <text x="991" y="530" fill="#8892b0" font-size="8">Format conversion</text>
  <text x="991" y="543" fill="#8892b0" font-size="8">Quality settings</text>
  <text x="991" y="556" fill="#8892b0" font-size="8">Border / glow</text>
  <text x="991" y="569" fill="#8892b0" font-size="8">Batch processing</text>
</svg>
